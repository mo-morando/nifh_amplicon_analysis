import importlib

# Check if pandas is installed
try:
    importlib.import_module('pandas')
except ImportError:
    print("pandas is not installed. Installing...")
    import subprocess
    subprocess.check_call(['pip3', 'install', 'pandas'])

# Now import pandas
import pandas as pd

def filter_pandas_csv(input_csv_path, output_csv_path, min_qcovs, min_pident):
    # Read the CSV file into a DataFrame
    df = pd.read_csv(input_csv_path)

    # Filter rows based on criteria
    filtered_df = df[(df['qcovs'] >= min_qcovs) & (df['pident'] >= min_pident)]

    # Write the filtered DataFrame to the output CSV file
    filtered_df.to_csv(output_csv_path, index=False)

    print("Filtered data has been written to", output_csv_path)

# Example usage:
# filter_csv('input.csv', 'filtered_output.csv', 70, 97)
filter_pandas_csv("auid.filtered.nifHDB_file.csv", "filtered_pandas_output.csv", 70, 97)
